# 多环境配置使用说明

## 概述
本项目现在支持 dev（开发）、test（测试）、prod（生产）三个环境的配置管理。

## 环境配置文件结构

```
app/config/
├── base.yaml       # 基础配置模板
├── dev.yaml        # 开发环境配置
├── test.yaml       # 测试环境配置
└── prod.yaml       # 生产环境配置
```

## 环境切换方式

### 1. 通过环境变量设置
```bash
# 设置为开发环境
export HAIVEN_ENV=dev

# 设置为测试环境
export HAIVEN_ENV=test

# 设置为生产环境
export HAIVEN_ENV=prod
```

## 各环境特点

### 开发环境 (dev)
- 使用较便宜的模型（如 gpt-4o-mini）
- 启用调试模式
- 详细日志记录
- 较短的缓存时间
- 本地数据库连接

### 测试环境 (test)
- 使用中等性能模型
- 启用测试模式
- 性能监控
- 自动化测试支持
- 模拟外部API调用

### 生产环境 (prod)
- 使用最佳性能模型（如 Claude-3.7）
- 启用所有提供商以确保冗余
- 强化安全配置
- 完整的监控和告警
- 加密敏感数据

## 配置继承机制

每个环境配置都可以继承基础配置：
- `extends: base.yaml` 表示继承基础配置
- 环境特定的配置会覆盖基础配置中的相同字段
- 支持深度合并嵌套对象

## 部署建议

1. **开发环境**: 本地开发，使用 `HAIVEN_ENV=dev`
2. **测试环境**: CI/CD 管道，使用 `HAIVEN_ENV=test`
3. **生产环境**: 生产服务器，使用 `HAIVEN_ENV=prod`

## 注意事项

1. 确保每个环境都有对应的环境变量文件
2. 生产环境的敏感信息应该通过安全的方式管理（如 Docker secrets、Kubernetes secrets）
3. 不同环境使用不同的数据库和知识库路径
4. 定期检查和更新环境配置，确保安全性
